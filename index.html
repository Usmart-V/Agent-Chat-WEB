<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agente AI de Factoriapp</title>
    <!-- Enlace para las fuentes Montserrat, Roboto y Space Grotesk de Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;1,400&family=Roboto:ital,wght@0,400;0,700;1,400&family=Space+Grotesk:wght@500&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Roboto', sans-serif; /* Usando la fuente Roboto por defecto */
            background-color: #323232;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Alineado arriba */
        }

        .main-container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            justify-content: center; /* Centrando el contenido principal */
            align-items: flex-start; /* Alineado arriba */
            flex-wrap: wrap;
            margin-top: 100px;
        }

        .left-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 350px;
            text-align: center;
        }

        .right-column {
            width: 100%;
            max-width: 650px;
            text-align: center;
            margin-left: 50px;
            margin-top: -80px; /* Ajuste para subir el monitor 4 líneas */
        }
        
        .large-image {
            width: 100%;
            height: auto;
            border-radius: 20px;
            transition: opacity 1.5s ease-in-out;
        }

        .header-logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 220px;
            height: auto;
        }
        
        /* Estilo para el nuevo texto */
        .header-text {
            position: absolute;
            top: 75px;
            left: 30px;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 20px;
            color: #E4EEF4;
            font-weight: 500;
        }
        
        /* Estilo para las letras destacadas */
        .highlight-color {
            color: #27D5D5;
        }

        /* Estilos del chat-widget para que se vea centrado en la página */
        .chat-widget {
            position: relative;
            width: 630px;
            margin: 0 auto;
        }

        /* Nuevo estilo para el marco del monitor */
        .tablet-frame {
            position: relative;
            background-color: black;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
            margin: auto;
        }

        .chat-button {
            width: 60px;
            height: 60px;
            background-color: black;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 20px auto;
        }

        .chat-button:hover {
            transform: scale(1.1);
        }

        .chat-icon {
            display: block;
            width: 35px;
            height: 35px;
            color: white;
        }

        .close-icon-svg {
            display: none;
            width: 24px;
            height: 24px;
        }
        
        .chat-button.active .chat-icon {
            display: none;
        }

        .chat-button.active .close-icon-svg {
            display: block;
        }

        .chat-container {
            position: relative;
            width: 600px;
            height: 450px;
            background: #e4eef4;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            margin: 0 auto;
        }

        .chat-container.open {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .chat-header {
            background-color: #2A5D75;
            color: #E4EEF4;
            padding: 20px;
            text-align: left;
            font-family: 'Space Grotesk', sans-serif;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .chat-header .status {
            font-size: 12px;
            opacity: 0.9;
            margin-top: 4px;
            color: #27D5D5;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: transparent;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
        }

        .message.user .message-content {
            background-color: #2A5D75;
            color: white;
            border-bottom-right-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-style: italic;
        }

        .message.bot .message-content {
            background: #dbe7ec;
            color: #333;
            border: 1px solid #e1e8ed;
            border-bottom-left-radius: 6px;
            font-family: 'Montserrat', sans-serif;
        }

        .bot-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            margin-top: 2px;
        }

        .chat-input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e1e8ed;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            border: 1px solid #e1e8ed;
            border-radius: 25px;
            padding: 12px 16px;
            font-size: 14px;
            outline: none;
            resize: none;
            max-height: 60px;
            min-height: 40px;
            font-family: 'Roboto', sans-serif;
            font-style: italic;
        }

        .chat-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .send-button {
            background-color: #2A5D75;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-button:hover {
            transform: scale(1.1);
        }

        .typing-indicator {
            display: none;
            padding: 10px 16px;
            color: #666;
            font-size: 12px;
            font-style: italic;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Botón de Volver */
        .back-button {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
            color: #9FC99B;
            font-family: 'Roboto', sans-serif;
            font-size: 12px;
            font-weight: 700;
            transition: color 0.3s ease;
        }

        .back-button:hover {
            color: #E4EEF4;
        }

        .back-button-arrow {
            width: 12px;
            height: 12px;
            fill: currentColor; /* El color se hereda del padre */
        }
        
        /* Media queries para adaptar el diseño a pantallas más pequeñas */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                justify-content: center;
            }
            .left-column, .right-column {
                max-width: 100%;
                margin: 20px 0;
            }
            .right-column {
                margin-left: 0;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>
    <img src="https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/logo4-YrDJvpa3V6sRZV5K.png" alt="Logo de Factoriapp" class="header-logo">
    <div class="header-text">
        <span class="highlight-color">I</span>nteligencia <span class="highlight-color">A</span>rtificial <span class="highlight-color">E</span>specializada
    </div>
    
    <a href="https://factoriapp.io/" class="back-button">
        <svg class="back-button-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/>
        </svg>
        <span>Volver</span>
    </a>

    <div class="main-container">
        <!-- Contenido de la izquierda (imagen) -->
        <div class="left-column">
            <!-- Enlace a la imagen de Factorín, ahora con un ID para poder cambiarla -->
            <img id="factorinImage" src="https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/1ai-2-AE0rRMkzMaFpB019.png" alt="Agente AI de Factoriapp" class="large-image">
        </div>

        <!-- Contenido de la derecha (chat) -->
        <div class="right-column">
            <div class="chat-widget">
                <button class="chat-button active" onclick="toggleChat()">
                    <!-- Icono de chat genérico en SVG -->
                    <svg class="chat-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <!-- Icono de encendido/apagado de Android en SVG, con color y animación de rotación -->
                    <svg class="close-icon-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#27D5D5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path>
                        <line x1="12" y1="2" x2="12" y2="12"></line>
                    </svg>
                    <div class="notification-badge" id="notificationBadge">1</div>
                </button>
                
                <div class="tablet-frame">
                    <div class="chat-container open" id="chatContainer">
                        <div class="chat-header">
                            <h3>Agente AI Factoriapp</h3>
                            <div class="status">En línea</div>
                        </div>
                        
                        <div class="chat-messages" id="chatMessages">
                            <div class="message bot">
                                <!-- La URL de la nueva imagen del bot se ha actualizado aquí -->
                                <img src="https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/carita-YKblRNo4GNtPJyvp.png" alt="Bot" class="bot-avatar">
                                <div class="message-content">
                                    ¡Hola! Soy tu Agente de Información de Factoriapp. Estoy aquí para ofrecerte información y ayudarte a resolver cualquier duda.
                                </div>
                            </div>
                        </div>
                        
                        <div class="typing-indicator" id="typingIndicator">
                            El agente está escribiendo...
                        </div>
                        
                        <div class="chat-input-container">
                            <textarea class="chat-input" id="chatInput" placeholder="Escribe tu mensaje..." rows="1"></textarea>
                            <button class="send-button" onclick="sendMessage()" id="sendButton">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"></line>
                                    <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Variables para el estado del chat
        let isOpen = true; // El chat está abierto por defecto
        let messageCount = 0;
        let responseCount = 0; // Nuevo contador para la respuesta del bot

        // Array de URLs para las imágenes de Factorín
        const factorinImages = [
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/1ai-2-AE0rRMkzMaFpB019.png",
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/1ai-s3-dOqDR7QRlpfxeD5l.png",
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/1ai-6b-YBgbR82RlnHrQk3m.png",
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/1ai-1-YbNJEZ2xvEflOZEk.png",
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/sentado-ALpPROklpBCXy5bk.png",
            "https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/sentado_i-AQEZl4kMVwT5D1jB.png"
        ];
        let currentImageIndex = 0;

        // Función para cambiar la imagen de Factorín con precarga
        function changeFactorinImage() {
            const factorinImageElement = document.getElementById('factorinImage');
            if (factorinImages.length > 1) {
                // Inicia la transición de salida (fade-out)
                factorinImageElement.style.opacity = 0; 
                
                // Espera a que termine el fade-out para cambiar la imagen
                setTimeout(() => {
                    const nextImageIndex = (currentImageIndex + 1) % factorinImages.length;
                    const nextImage = new Image();
                    nextImage.src = factorinImages[nextImageIndex];
                    
                    nextImage.onload = () => {
                        factorinImageElement.src = nextImage.src; // Cambia la imagen
                        factorinImageElement.style.opacity = 1; // Inicia la transición de entrada (fade-in)
                        currentImageIndex = nextImageIndex;
                    };
                }, 1500); // 1.5 segundos, igual que la transición de opacidad
            }
        }

        // Función para alternar la visibilidad del chat
        function toggleChat() {
            const container = document.getElementById('chatContainer');
            const button = document.querySelector('.chat-button');
            const badge = document.getElementById('notificationBadge');
            
            if (isOpen) {
                container.classList.remove('open');
                setTimeout(() => {
                    container.style.display = 'none';
                }, 300);
                button.classList.remove('active');
                isOpen = false;
            } else {
                container.style.display = 'flex';
                setTimeout(() => {
                    container.classList.add('open');
                }, 10);
                button.classList.add('active');
                badge.style.display = 'none';
                isOpen = true;
                setTimeout(() => {
                    document.getElementById('chatInput').focus();
                }, 400);
            }
        }

        // Función para enviar un mensaje del usuario
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message === '') return;
            
            addMessage(message, 'user');
            input.value = '';
            
            showTypingIndicator();
            
            // Simular una respuesta del bot
            setTimeout(() => {
                hideTypingIndicator();
                const botResponse = generateBotResponse(message);
                addMessage(botResponse, 'bot');
                
                // Aumenta el contador de respuestas del bot y cambia la imagen si llega a 3
                responseCount++;
                if (responseCount >= 3) {
                    changeFactorinImage();
                    responseCount = 0; // Reinicia el contador
                }
            }, 1500);
        }

        // Función para agregar un mensaje al chat
        function addMessage(message, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            let messageHTML = '';
            if (sender === 'bot') {
                // La URL de la nueva imagen del bot se ha actualizado aquí
                messageHTML = `
                    <img src="https://assets.zyrosite.com/A1a5bgp0z1sGxPEw/carita-YKblRNo4GNtPJyvp.png" alt="Bot" class="bot-avatar">
                    <div class="message-content">${message}</div>
                `;
            } else {
                messageHTML = `<div class="message-content">${message}</div>`;
            }
            
            messageDiv.innerHTML = messageHTML;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            if (!isOpen && sender === 'bot') {
                showNotification();
            }
        }

        // Funciones para el indicador de escritura del bot
        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // Función para mostrar la notificación de mensajes nuevos
        function showNotification() {
            const badge = document.getElementById('notificationBadge');
            badge.style.display = 'flex';
            messageCount++;
            badge.textContent = messageCount;
        }

        // Función para generar una respuesta aleatoria del bot
        function generateBotResponse(userMessage) {
            const responses = [
                "¡Gracias por tu mensaje! ¿En qué más puedo ayudarte?",
                "Entiendo tu consulta. Permíteme ayudarte con eso.",
                "¡Perfecto! Estoy aquí para resolver todas tus dudas sobre Factoriapp.",
                "Es un placer ayudarte. ¿Hay algo específico que necesites saber?",
                "¡Excelente pregunta! Te ayudo de inmediato."
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Event listener para enviar mensaje con la tecla Enter
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Ajustar la altura del textarea de forma automática
        document.getElementById('chatInput').addEventListener('input', function() {
            this.style.height = '40px';
            this.style.height = Math.min(this.scrollHeight, 60) + 'px';
        });

        // Asegurarse de que el chat está abierto al cargar la página y el botón tiene el estado correcto
        window.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('chatContainer');
            const button = document.querySelector('.chat-button');
            const badge = document.getElementById('notificationBadge');
            
            container.classList.add('open');
            container.style.display = 'flex';
            button.classList.add('active');
            badge.style.display = 'none'; // Ocultar la notificación inicial
            isOpen = true;
            setTimeout(() => {
                document.getElementById('chatInput').focus();
            }, 400);
        });
    </script>
</body>
</html>
